<html>
    <head>
        <script>
            window.jQuery = window.$ = require('jquery');
            const { ipcRenderer } = require('electron');
        </script>
        <link rel="stylesheet" href="pad/numpad-dark.css"/>
        <script src="pad/numpad.js"></script>
        <link rel="stylesheet" href="https://cdn.snaildos.com/w3.css">
        <link rel="stylesheet" href="./titlebar/titlebar.css">
        <script src="https://cdn.snaildos.com/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.snaildos.com/bootstrap.min.css">
        <script src="https://cdn.snaildos.com/bootstrap.min.js"></script>
        <title>SnailPortal - Encrypt</title>
               <script>
        $(document).ready(function () {
            $(".divs div").each(function (e) {
                if (e != 0)
                    $(this).hide();
            });

            $("#1").click(function () {
                if ($(".divs div:visible").next().length != 0)
                    $(".divs div:visible").next().show().prev().hide();
                else {
                    $(".divs div:visible").hide();
                    $(".divs div:first").show();
                }
                return false;
            });

            $("#2").click(function () {
                if ($(".divs div:visible").next().length != 0)
                    $(".divs div:visible").next().show().prev().hide();
                else {
                    $(".divs div:visible").hide();
                    $(".divs div:first").show();
                }
                return false;
            });

            $("#3").click(function () {
                if ($(".divs div:visible").next().length != 0)
                    $(".divs div:visible").next().show().prev().hide();
                else {
                    $(".divs div:visible").hide();
                    $(".divs div:first").show();
                }
                return false;
            });

            $("#prev").click(function () {
                if ($(".divs div:visible").prev().length != 0)
                    $(".divs div:visible").prev().show().next().hide();
                else {
                    $(".divs div:visible").hide();
                    $(".divs div:last").show();
                }
                return false;
            });
        });

    </script>
        <style>
        main  {
            font-size: 50px;
        }
        body {
   background-color: rgba(255,255,255,0.5);
   background: transparent;
   user-select: none; /* supported by Chrome and Opera */
   -webkit-user-select: none; /* Safari */
   -khtml-user-select: none; /* Konqueror HTML */
   -moz-user-select: none; /* Firefox */
   -ms-user-select: none; /* Internet Explorer/Edge */
        }

        .hidden  {
            opacity: 0.0;
        }

        h1,h2,h3,h4,h5,h6,a,button  {
            color: white;
            
        }
        .ctrl {
            color: white;
            font-size: 35px;
        }
        </style>
        <Script>
            function store3()  {
const Store = require('electron-store');
var pass123 = $('#passbox').val();
console.log('Encryption start!')
var pin = new Store({
    name: "pin",
    encryptionKey: pass123
})
pin.set('isencrypted', 'true')
pin.set('pin', pass123)
$(".divs div:visible").next().length != 0
$(".divs div:visible").next().show().prev().hide()
const security = new Store()
security.set('pin', 'true')
console.log('Enc complete.')
            }
        </script>
        <script>
            function complete(){
                ipcRenderer.send('relaunch');
            }
        </script>
    </head>
    <body>
        <header data-for-os="windows" id="titlebar" class="titlebar">
            <div id="window-controls">
              <div onclick="ipcRenderer.send('minimize')" class="button" id="min-button"><img class="icon" srcset="./icons/titlebar/min-w-10.png 1x, ./icons/titlebar/min-w-12.png 1.25x, ./icons/titlebar/min-w-15.png 1.5x, ./icons/titlebar/min-w-15.png 1.75x, ./icons/titlebar/min-w-20.png 2x, ./icons/titlebar/min-w-20.png 2.25x, ./icons/titlebar/min-w-24.png 2.5x, ./icons/titlebar/min-w-30.png 3x, ./icons/titlebar/min-w-30.png 3.5x" draggable="false" /></div>
              <div onclick="ipcRenderer.send('close')" class="button" id="close-button"><img class="icon" srcset="./icons/titlebar/close-w-10.png 1x, ./icons/titlebar/close-w-12.png 1.25x, ./icons/titlebar/close-w-15.png 1.5x, ./icons/titlebar/close-w-15.png 1.75x, ./icons/titlebar/close-w-20.png 2x, ./icons/titlebar/close-w-20.png 2.25x, ./icons/titlebar/close-w-24.png 2.5x, ./icons/titlebar/close-w-30.png 3x, ./icons/titlebar/close-w-30.png 3.5x" draggable="false" /></div>
            </div>
          </header>
        <div class="divs">
            <center>
            <div class="cls1"><h2 class="main" class="w3-center">Welcome the the encryptor.<p><p><button id="1" class="ctrl w3-center w3-white w3-round-xlarge">Next!</button><h2 class="hidden">h</h2></p></h2></div>
            <div class="cls2"><h2 class="main" class="w3-center">Any password typed in here, will create a new local database and encrypt it. Forgetting your pin = loosing everything.<p><button id="2" class="w3-center w3-white w3-round-xlarge ctrl">Ok</button><h2 class="hidden">h</h2></p></h2> <p></div>
            <div class="cls3"><h4 class="main" class="w3-center"><h2 class="w3-center">Enter a pin:</h2>
                <p>
                    <h2 class="w3-center">Press the "Start Encryption!" button when completed..</h2>
                </p>
                <p>

                </p><form class="w3-center" onsubmit="store3(); return false;"> 
                <input class="passbox" id="passbox" name="passbox" type="password" id="passbox" required="true" placeholder="" />
                <p>
                    <h1 class="invisible">h</h1>
                    <button class="w3-center w3-white w3-round-xlarge ctrl" onclick="store3()">Start Encryption!</button>
                </p>
                </form></h4><h2 class="hidden">h</h2></div>
            <div class="cls4"><h4 class="main" class="w3-center">Finished.<p></p> <button class="w3-center w3-white w3-round-xlarge ctrl" onClick="complete()">Relaunch</button></h4></div>
        </div>
        <script>
            window.addEventListener("load", function(){
              // WITH OPTIONS
              numpad.attach({
                target: "passbox",
                max: 4,
                decimal: false
              });
            });
            </script>
        <div class="w3-center">
            
            <h1 class="hidden">h<p>h<p>h</p></h1>
        </div>
    </center>
    </body>
</html>